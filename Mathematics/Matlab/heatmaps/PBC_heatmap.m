%open heatmap

%% load data new
D1 = [[0.65   1.     1.     1.     1.     1.     1.     1.     1.     1.  1.    ]
 [0.3    0.6975 0.7594 0.7987 0.8208 0.8394 0.8532 0.8649 0.8739 0.8819 0.8884]
 [0.3    0.6361 0.699  0.7362 0.7631 0.7822 0.7979 0.8111 0.8233 0.8325 0.8402]
 [0.3    0.6024 0.665  0.702  0.728  0.7486 0.7644 0.778  0.7894 0.8 0.8087]
 [0.3    0.58   0.6414 0.6773 0.7031 0.7231 0.7402 0.7539 0.7659 0.7764 0.7855]
 [0.3    0.565  0.6228 0.6588 0.6851 0.705  0.7216 0.7352 0.7466 0.7576 0.7669]
 [0.3    0.5539 0.6101 0.6447 0.67   0.6898 0.7067 0.72   0.732  0.7424 0.7517]
 [0.3    0.5446 0.5981 0.6324 0.6578 0.6776 0.6933 0.7074 0.719  0.7298 0.7393]
 [0.3    0.5349 0.5905 0.6237 0.6483 0.6679 0.6834 0.6974 0.7092 0.7195 0.7285]
 [0.3    0.5276 0.5827 0.6154 0.6394 0.6587 0.6749 0.6885 0.6999 0.71 0.7196]
 [0.3    0.5219 0.5756 0.6077 0.6321 0.6508 0.6667 0.6802 0.6913 0.7024 0.7112]];

D2 = [[0.65   0.3    0.3    0.3    0.3    0.3    0.3    0.3    0.3    0.3  0.3   ]
 [1.     0.6025 0.5406 0.5013 0.4792 0.4606 0.4468 0.4351 0.4261 0.4181  0.4116]
 [1.     0.6639 0.601  0.5638 0.5369 0.5178 0.5021 0.4889 0.4767 0.4675  0.4598]
 [1.     0.6976 0.635  0.598  0.572  0.5514 0.5356 0.522  0.5106 0.5  0.4913]
 [1.     0.72   0.6586 0.6227 0.5969 0.5769 0.5598 0.5461 0.5341 0.5236  0.5145]
 [1.     0.735  0.6772 0.6412 0.6149 0.595  0.5784 0.5648 0.5534 0.5424  0.5331]
 [1.     0.7461 0.6899 0.6553 0.63   0.6102 0.5933 0.58   0.568  0.5576 0.5483]
 [1.     0.7554 0.7019 0.6676 0.6422 0.6224 0.6067 0.5927 0.581  0.5702  0.5607]
 [1.     0.7651 0.7095 0.6763 0.6517 0.6321 0.6166 0.6026 0.5908 0.5805  0.5715]
 [1.     0.7724 0.7173 0.6846 0.6606 0.6413 0.6251 0.6115 0.6001 0.59  0.5804]
 [1.     0.7781 0.7244 0.6923 0.6679 0.6492 0.6333 0.6198 0.6087 0.5976  0.5888]];


C11 = [[0.231 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.212 0.257 0.216 0.184 0.164 0.161 0.139 0.123 0.119 0.104 0.109]
 [0.212 0.278 0.253 0.229 0.213 0.191 0.171 0.165 0.156 0.143 0.137]
 [0.213 0.286 0.273 0.25  0.239 0.217 0.2   0.187 0.172 0.17  0.162]
 [0.213 0.288 0.282 0.264 0.24  0.228 0.22  0.214 0.194 0.187 0.168]
 [0.213 0.292 0.286 0.271 0.249 0.241 0.222 0.217 0.204 0.197 0.192]
 [0.212 0.287 0.29  0.266 0.254 0.247 0.233 0.221 0.219 0.208 0.205]
 [0.212 0.287 0.296 0.278 0.271 0.257 0.237 0.229 0.222 0.217 0.205]
 [0.212 0.292 0.293 0.28  0.267 0.256 0.249 0.239 0.231 0.214 0.209]
 [0.213 0.289 0.292 0.282 0.277 0.258 0.258 0.243 0.235 0.226 0.211]
 [0.213 0.289 0.294 0.287 0.269 0.261 0.251 0.238 0.231 0.226 0.223]];

C12 = [[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.021 0.027 0.033 0.037 0.034 0.042 0.042 0.043 0.041 0.043]
 [0.    0.031 0.042 0.052 0.055 0.059 0.065 0.067 0.063 0.073 0.073]
 [0.    0.036 0.051 0.066 0.069 0.079 0.08  0.087 0.089 0.094 0.096]
 [0.    0.041 0.057 0.071 0.081 0.091 0.09  0.097 0.103 0.105 0.116]
 [0.    0.044 0.063 0.078 0.087 0.097 0.108 0.11  0.115 0.119 0.12 ]
 [0.    0.048 0.068 0.087 0.103 0.104 0.119 0.121 0.127 0.13  0.133]
 [0.    0.051 0.074 0.086 0.101 0.114 0.123 0.127 0.136 0.141 0.143]
 [0.    0.052 0.075 0.091 0.109 0.12  0.129 0.13  0.148 0.148 0.153]
 [0.    0.056 0.076 0.097 0.109 0.123 0.13  0.137 0.144 0.157 0.167]
 [0.    0.06  0.081 0.095 0.119 0.131 0.14  0.15  0.157 0.163 0.171]];

C21 = [[0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.027 0.04  0.042 0.05  0.045 0.048 0.048 0.048 0.045 0.047]
 [0.    0.037 0.052 0.061 0.067 0.07  0.065 0.073 0.067 0.072 0.073]
 [0.    0.046 0.06  0.07  0.082 0.087 0.086 0.093 0.086 0.094 0.096]
 [0.    0.04  0.069 0.078 0.091 0.096 0.1   0.109 0.108 0.111 0.11 ]
 [0.    0.04  0.072 0.085 0.097 0.102 0.111 0.115 0.12  0.118 0.124]
 [0.    0.043 0.077 0.088 0.103 0.109 0.123 0.129 0.133 0.132 0.138]
 [0.    0.044 0.081 0.096 0.112 0.118 0.126 0.133 0.139 0.149 0.145]
 [0.    0.049 0.079 0.099 0.116 0.127 0.132 0.144 0.152 0.148 0.154]
 [0.    0.048 0.079 0.1   0.121 0.128 0.146 0.148 0.15  0.158 0.167]
 [0.    0.051 0.076 0.103 0.122 0.136 0.144 0.152 0.157 0.164 0.175]];

C22 = [[0.199 0.212 0.214 0.212 0.213 0.212 0.211 0.214 0.214 0.212 0.211]
 [0.    0.186 0.206 0.213 0.213 0.204 0.206 0.216 0.205 0.213 0.202]
 [0.    0.157 0.174 0.187 0.19  0.196 0.204 0.195 0.203 0.198 0.199]
 [0.    0.143 0.16  0.168 0.173 0.18  0.184 0.18  0.189 0.187 0.181]
 [0.    0.133 0.147 0.16  0.166 0.171 0.176 0.165 0.175 0.175 0.178]
 [0.    0.126 0.142 0.148 0.16  0.158 0.164 0.169 0.167 0.166 0.164]
 [0.    0.121 0.132 0.146 0.151 0.158 0.155 0.157 0.152 0.16  0.155]
 [0.    0.119 0.126 0.134 0.138 0.147 0.151 0.15  0.148 0.149 0.155]
 [0.    0.112 0.123 0.135 0.134 0.141 0.142 0.146 0.142 0.146 0.148]
 [0.    0.105 0.12  0.129 0.133 0.135 0.131 0.137 0.143 0.136 0.142]
 [0.    0.104 0.112 0.122 0.126 0.13  0.13  0.134 0.137 0.136 0.136]];

C_tot = [[0.43  0.212 0.214 0.212 0.213 0.212 0.211 0.214 0.214 0.212 0.211]
 [0.212 0.491 0.488 0.472 0.463 0.444 0.435 0.429 0.414 0.404 0.401]
 [0.212 0.503 0.522 0.529 0.526 0.517 0.504 0.499 0.488 0.487 0.481]
 [0.213 0.512 0.544 0.555 0.562 0.563 0.55  0.547 0.536 0.545 0.535]
 [0.213 0.501 0.554 0.573 0.579 0.586 0.586 0.586 0.58  0.578 0.572]
 [0.213 0.502 0.563 0.582 0.593 0.599 0.604 0.612 0.606 0.601 0.599]
 [0.212 0.499 0.567 0.587 0.612 0.618 0.629 0.628 0.631 0.629 0.631]
 [0.212 0.501 0.576 0.594 0.622 0.636 0.637 0.64  0.645 0.656 0.648]
 [0.212 0.505 0.569 0.606 0.626 0.643 0.652 0.658 0.673 0.657 0.664]
 [0.213 0.498 0.566 0.608 0.641 0.644 0.666 0.665 0.671 0.676 0.686]
 [0.213 0.505 0.563 0.607 0.636 0.659 0.665 0.675 0.681 0.689 0.704]];



%% load data old
D1_old = [[0.3    0.9446 0.9467 0.9425 0.9338 0.9375 0.9303 0.9291 0.9317 0.9272] %density lattice 1
 [0.3    0.6935 0.7576 0.7942 0.8173 0.836  0.8493 0.8608 0.8713 0.8782]
 [0.3    0.6348 0.6976 0.7355 0.761  0.7812 0.7971 0.8103 0.8203 0.8297]
 [0.3    0.6034 0.6629 0.7003 0.7271 0.7475 0.764  0.7778 0.7881 0.7984]
 [0.3    0.5812 0.6401 0.6769 0.7021 0.7238 0.7403 0.7541 0.7659 0.7762]
 [0.3    0.5653 0.6232 0.6594 0.6851 0.7055 0.7223 0.7353 0.7474 0.7578]
 [0.3    0.5549 0.6114 0.6465 0.6714 0.6906 0.7069 0.7214 0.7326 0.7429]
 [0.3    0.5449 0.6001 0.6338 0.6598 0.6788 0.6948 0.7083 0.7204 0.7307]
 [0.3    0.5373 0.5915 0.6253 0.6492 0.6686 0.6845 0.6981 0.7099 0.7204]
 [0.3    0.5307 0.5837 0.6168 0.6412 0.6606 0.6758 0.6893 0.7014 0.7112]];

D2_old = [[1.     0.3554 0.3533 0.3575 0.3662 0.3625 0.3697 0.3709 0.3683 0.3728]
 [1.     0.6065 0.5424 0.5058 0.4827 0.464  0.4507 0.4392 0.4287 0.4218]
 [1.     0.6652 0.6024 0.5645 0.539  0.5188 0.5029 0.4897 0.4797 0.4703]
 [1.     0.6966 0.6371 0.5997 0.5729 0.5525 0.536  0.5222 0.5119 0.5016]
 [1.     0.7188 0.6599 0.6231 0.5979 0.5762 0.5597 0.5459 0.5341 0.5238]
 [1.     0.7347 0.6768 0.6406 0.6149 0.5945 0.5777 0.5647 0.5526 0.5422]
 [1.     0.7451 0.6886 0.6535 0.6286 0.6094 0.5931 0.5786 0.5674 0.5571]
 [1.     0.7551 0.6999 0.6662 0.6402 0.6212 0.6052 0.5917 0.5796 0.5693]
 [1.     0.7627 0.7085 0.6747 0.6508 0.6314 0.6155 0.6019 0.5901 0.5796]
 [1.     0.7693 0.7163 0.6832 0.6588 0.6394 0.6242 0.6107 0.5986 0.5888]];

C11_old = [[0.213 0.003 0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.212 0.231 0.184 0.143 0.122 0.101 0.087 0.078 0.068 0.061]
 [0.212 0.265 0.232 0.203 0.175 0.148 0.14  0.13  0.116 0.114]
 [0.213 0.278 0.25  0.226 0.205 0.19  0.173 0.16  0.15  0.138]
 [0.212 0.279 0.262 0.245 0.224 0.212 0.192 0.182 0.176 0.161]
 [0.21  0.285 0.281 0.251 0.234 0.226 0.214 0.201 0.189 0.172]
 [0.215 0.288 0.279 0.266 0.255 0.235 0.226 0.212 0.198 0.192]
 [0.211 0.29  0.285 0.271 0.254 0.246 0.236 0.22  0.204 0.197]
 [0.212 0.292 0.289 0.28  0.264 0.255 0.242 0.228 0.224 0.209]
 [0.212 0.293 0.289 0.283 0.268 0.255 0.248 0.235 0.225 0.22 ]];

C12_old = [[0.    0.163 0.207 0.233 0.249 0.253 0.255 0.255 0.255 0.254]
 [0.    0.107 0.14  0.158 0.172 0.184 0.186 0.189 0.194 0.193]
 [0.    0.086 0.119 0.145 0.161 0.175 0.183 0.186 0.197 0.191]
 [0.    0.078 0.118 0.135 0.148 0.162 0.17  0.176 0.183 0.191]
 [0.    0.076 0.11  0.129 0.147 0.153 0.169 0.177 0.18  0.188]
 [0.    0.07  0.101 0.12  0.139 0.149 0.154 0.17  0.179 0.18 ]
 [0.    0.065 0.092 0.117 0.131 0.142 0.156 0.158 0.172 0.179]
 [0.    0.06  0.091 0.113 0.13  0.142 0.154 0.163 0.166 0.177]
 [0.    0.06  0.087 0.107 0.122 0.134 0.151 0.162 0.166 0.17 ]
 [0.    0.06  0.087 0.106 0.124 0.137 0.145 0.16  0.166 0.172]];

C21_old = [[0.    0.01  0.011 0.006 0.002 0.002 0.001 0.    0.    0.   ]
 [0.    0.046 0.06  0.067 0.074 0.079 0.077 0.072 0.079 0.081]
 [0.    0.049 0.069 0.083 0.094 0.098 0.102 0.11  0.101 0.102]
 [0.    0.051 0.077 0.082 0.103 0.109 0.112 0.118 0.12  0.123]
 [0.    0.051 0.08  0.1   0.11  0.118 0.123 0.127 0.138 0.135]
 [0.    0.048 0.079 0.097 0.106 0.118 0.132 0.139 0.139 0.14 ]
 [0.    0.052 0.083 0.102 0.121 0.127 0.136 0.141 0.149 0.148]
 [0.    0.054 0.08  0.105 0.114 0.131 0.144 0.152 0.152 0.162]
 [0.    0.056 0.083 0.106 0.118 0.137 0.152 0.159 0.161 0.162]
 [0.    0.052 0.083 0.109 0.127 0.142 0.154 0.159 0.164 0.168]];

C22_old = [[0.    0.1   0.053 0.023 0.007 0.004 0.001 0.    0.    0.   ]
 [0.    0.136 0.14  0.146 0.141 0.138 0.136 0.131 0.126 0.126]
 [0.    0.126 0.139 0.14  0.141 0.144 0.14  0.14  0.135 0.133]
 [0.    0.12  0.135 0.144 0.141 0.144 0.147 0.148 0.139 0.142]
 [0.    0.114 0.133 0.133 0.139 0.143 0.143 0.142 0.138 0.138]
 [0.    0.117 0.124 0.14  0.144 0.143 0.143 0.135 0.14  0.15 ]
 [0.    0.111 0.121 0.128 0.138 0.14  0.136 0.142 0.138 0.147]
 [0.    0.11  0.126 0.125 0.137 0.134 0.133 0.136 0.142 0.139]
 [0.    0.106 0.121 0.124 0.132 0.136 0.133 0.131 0.135 0.142]
 [0.    0.101 0.118 0.125 0.124 0.128 0.134 0.136 0.135 0.131]];

C_tot_old = [[0.213 0.276 0.271 0.263 0.259 0.259 0.256 0.255 0.255 0.254]
 [0.212 0.52  0.524 0.515 0.508 0.501 0.486 0.469 0.467 0.461]
 [0.212 0.525 0.559 0.571 0.571 0.565 0.566 0.565 0.549 0.541]
 [0.213 0.527 0.579 0.588 0.597 0.605 0.602 0.602 0.592 0.594]
 [0.212 0.52  0.584 0.607 0.619 0.626 0.627 0.629 0.632 0.622]
 [0.21  0.52  0.585 0.608 0.623 0.636 0.643 0.644 0.646 0.642]
 [0.215 0.516 0.575 0.613 0.644 0.644 0.655 0.652 0.658 0.666]
 [0.211 0.514 0.581 0.615 0.636 0.653 0.666 0.671 0.665 0.675]
 [0.212 0.513 0.58  0.616 0.635 0.662 0.679 0.681 0.686 0.682]
 [0.212 0.507 0.578 0.624 0.644 0.662 0.681 0.69  0.69  0.691]];
%% heatmap 1 - D1

xvalues =  round(linspace(0,1,11),3);
yvalues =  flip(round(linspace(0,1,11),3));
h = heatmap(xvalues, yvalues,flip(D1), 'Colormap', hot, 'ColorLimits',[0 max(D1(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Density Heatmap of highway model with PBC in maximal current phase (ρ_t=1.3) "," ρ(k_{12}, k_{21})"};
h.xlabel('k_{21}');
h.ylabel('k_{12}');


%% heatmap D2
xvalues =  round(linspace(0,1,11),3);
yvalues =  flip(round(linspace(0,1,11),3));
h = heatmap(xvalues, yvalues,flip(D2), 'Colormap', hot, 'ColorLimits',[0 max(D2(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Density Heatmap of highway model with PBC in maximal current phase (ρ_t=1.3) "," γ(k_{12}, k_{21})"};
h.xlabel('k_{21}');
h.ylabel('k_{12}');

%% heatmap C11
xvalues =  round(linspace(0,1,11),3);
yvalues =  flip(round(linspace(0,1,11),3));
h = heatmap(xvalues, yvalues,flip(C11), 'Colormap', hot, 'ColorLimits',[0 max(C11(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Current Heatmap of highway model with PBC in maximal current phase (ρ_t=1.3) "," J^{11}(k_{12}, k_{21})"};
h.xlabel('k_{21}');
h.ylabel('k_{12}');

%% heatmap C12
xvalues =  round(linspace(0,1,11),3);
yvalues =  flip(round(linspace(0,1,11),3));
h = heatmap(xvalues, yvalues,flip(C12), 'Colormap', hot, 'ColorLimits',[0 max(C12(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Current Heatmap of highway model with PBC in maximal current phase (ρ_t=1.3) "," J^{12}(k_{12}, k_{21})"};
h.xlabel('k_{21}');
h.ylabel('k_{12}');


%% heatmap C21
xvalues =  round(linspace(0,1,11),3);
yvalues =  flip(round(linspace(0,1,11),3));
h = heatmap(xvalues, yvalues,flip(C21), 'Colormap', hot, 'ColorLimits',[0 max(C21(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Current Heatmap of highway model with PBC in maximal current phase (ρ_t=1.3) "," J^{21}(k_{12}, k_{21})"};
h.xlabel('k_{21}');
h.ylabel('k_{12}');


%% heatmap C22
xvalues =  round(linspace(0,1,11),3);
yvalues =  flip(round(linspace(0,1,11),3));

h = heatmap(xvalues, yvalues,flip(C22), 'Colormap', hot, 'ColorLimits',[0 max(C22(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Current Heatmap of highway model with PBC in maximal current phase (ρ_t=1.3) ", "J^{22}(k_{12}, k_{21})"} ;
h.xlabel('k_{21}');
h.ylabel('k_{12}');
%% heatmap C_tot
xvalues =  round(linspace(0,1,11),3);
yvalues =  flip(round(linspace(0,1,11),3));

h = heatmap(xvalues, yvalues,flip(C_tot), 'Colormap', hot, 'ColorLimits',[0 max(C_tot(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Current Heatmap of highway model with PBC in maximal current phase (ρ_t=1.3) ", "J_{tot}(k_{12}, k_{21})"} ;
h.xlabel('k_{21}');
h.ylabel('k_{12}');


%% heatmap D2 another
xvalues =  [0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ];
yvalues =  flip([0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ]);

h = heatmap(xvalues, yvalues,flip(D2), 'Colormap', hot, 'ColorLimits',[0 max(D2(:))], 'GridVisible', 'off', 'CellLabelColor','none');
h.Title = {"Current Heatmap of open lattice 2, D_2(α_1, k_{12}^1)", "β_1=1, α_{2} = 0.2, β_2=0.9, k_{11}^1 = k_{21}^1 = k_{22}^1 = 1, k_{22}^2 = 1 "};
h.xlabel('k_{12}');
h.ylabel('α_{1}');
